- name: update /etc/systemd/system/mongod-disable-thp.service
  copy: src=etc/systemd/system/mongod-disable-thp.service dest=/etc/systemd/system/mongod-disable-thp.service

- name: enable mongod-disable-thp service
  service: name=mongod-disable-thp state=restarted enabled=yes

- name: add mongodb repo key
  apt_key: id=EA312927 keyserver=hkp://keyserver.ubuntu.com:80

- name: add mongodb repo
  apt_repository: repo='deb http://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/3.2 multiverse'

- name: install mongodb
  apt: name=mongodb-org

- name: update /etc/logrotate.d/mongod
  copy: src=etc/logrotate.d/mongod dest=/etc/logrotate.d/mongod

- name: update /etc/mongod.conf
  template: src=etc/mongod.conf.j2 dest=/etc/mongod.conf
  notify: restart-mongodb

- name: enable mongodb service
  service: name=mongod enabled=yes
